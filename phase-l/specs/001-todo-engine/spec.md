# Feature Specification: Todo Engine

**Feature Branch**: `001-todo-engine`
**Created**: 2026-02-03
**Status**: Draft
**Input**: User description: "Phase I – In-Memory Todo Engine

# /sp.specify
Hackathon II — Spec-Driven Development
Project: The Evolution of Todo
Phase: I — In-Memory Console System

This document defines **what must be built** in Phase I.
All code generated by Claude Code must strictly implement this specification.

---

## 1. System Purpose

The Phase I system is a **single-user, in-memory Todo application** that allows a user to:

- Create tasks
- View tasks
- Update tasks
- Complete tasks
- Delete tasks

This phase establishes the **canonical Todo domain model** that all later phases will extend.

---

## 2. Core Domain

### 2.1 Task Entity

A Task represents a single todo item.

Each Task must contain:

| Field | Type | Description |
|------|------|-------------|
| id | string | Unique immutable identifier |
| title | string | Short human-readable description |
| completed | boolean | Whether the task is done |
| created_at | datetime | When task was created |
| updated_at | datetime | When task was last modified |

---

### 2.2 Task Rules

- Title cannot be empty
- IDs must be unique
- Creation time is immutable
- Updated time changes on any modification
- Completing a task must update `completed` and `updated_at`

---

## 3. Storage Layer

### 3.1 TaskRepository

All tasks must be stored in memory using a repository abstraction.

The repository must support:

- save(task)
- get_by_id(id)
- list_all()
- delete(id)
- update(task)

No direct data structure access is allowed outside this repository.

---

## 4. Service Layer

### 4.1 TodoService

All business logic must be implemented in a TodoService.

It must expose the following operations:

- create_task(title)
- list_tasks()
- complete_task(id)
- update_task(id, new_title)
- delete_task(id)

TodoService must:
- Validate input
- Enforce rules
- Call TaskRepository
- Return domain objects

---

## 5. CLI Interface

The user interacts with the system through commands.

### 5.1 Supported Commands

| Command | Behavior |
|--------|----------|
| add "title" | Creates a new task |
| list | Shows all tasks |
| complete <id> | Marks task as completed |
| update <id> "new title" | Updates task title |
| delete <id> | Deletes a task |
| exit | Ends the program |

---

### 5.2 CLI Rules

- CLI must never directly manipulate tasks
- CLI must only call TodoService
- CLI must catch and display all errors
- CLI must show human-readable output

---

## 6. Error Conditions

The system must handle:

| Case | Behavior |
|------|----------|
| Invalid command | Show help |
| Empty title | Reject |
| Unknown ID | Show error |
| Duplicate ID | Forbidden |
| Crash | Not allowed |

---

## 7. Deterministic Behavior

The same command sequence must always produce the same state and output.

No randomness, no hidden state, no external data.

---

## 8. Testing Requirements

The system must be testable via:

- Running the CLI
- Entering commands
- Observing deterministic output

No manual inspection of memory is allowed.

---

## 9. Upgrade Compatibility

The architecture must allow:

- TaskRep"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - Add New Tasks (Priority: P1)

A user wants to create new todo items to keep track of things they need to do. The user opens the CLI application and enters an "add" command with a task title. The system creates a new task with a unique ID and displays confirmation.

**Why this priority**: This is the foundational functionality - without the ability to add tasks, the system has no value.

**Independent Test**: Can be fully tested by running the CLI, entering "add 'Buy groceries'", and verifying that a new task with a unique ID appears in the task list.

**Acceptance Scenarios**:

1. **Given** user is at the CLI prompt, **When** user enters `add "Buy groceries"`, **Then** a new task with unique ID is created, marked as incomplete, with creation timestamp, and confirmation message is displayed
2. **Given** user enters `add ""` or `add` without title, **When** command is processed, **Then** an error message is displayed indicating title cannot be empty

---

### User Story 2 - View All Tasks (Priority: P1)

A user wants to see all their tasks to know what needs to be done. The user enters a "list" command and sees all tasks with their status and IDs.

**Why this priority**: Essential for the user to understand their task inventory and decide what to work on next.

**Independent Test**: Can be fully tested by adding a few tasks and then running the "list" command to see all tasks displayed in a readable format.

**Acceptance Scenarios**:

1. **Given** user has multiple tasks in the system, **When** user enters `list`, **Then** all tasks are displayed with ID, title, completion status, and timestamps
2. **Given** user has no tasks in the system, **When** user enters `list`, **Then** a message indicates that there are no tasks to display

---

### User Story 3 - Complete Tasks (Priority: P1)

A user wants to mark tasks as completed when they finish them. The user enters a "complete" command with a task ID, and the system updates the task status.

**Why this priority**: Critical functionality for the todo system - users need to mark tasks as done to track their progress.

**Independent Test**: Can be fully tested by adding a task, noting its ID, running the "complete <id>" command, and verifying the task is marked as completed.

**Acceptance Scenarios**:

1. **Given** user has an incomplete task with ID "123", **When** user enters `complete 123`, **Then** the task is marked as completed and the updated timestamp is changed
2. **Given** user enters `complete 999` where 999 is not a valid task ID, **When** command is processed, **Then** an error message is displayed indicating the task does not exist

---

### User Story 4 - Update Task Titles (Priority: P2)

A user wants to modify the title of an existing task if their requirements change. The user enters an "update" command with a task ID and new title.

**Why this priority**: Important for maintaining accurate task descriptions, though not as critical as the core CRUD operations.

**Independent Test**: Can be fully tested by adding a task, updating its title, and verifying the change is reflected when viewing the task list.

**Acceptance Scenarios**:

1. **Given** user has a task with ID "456" titled "Old title", **When** user enters `update 456 "New title"`, **Then** the task title is updated and the timestamp is changed
2. **Given** user enters `update 789 ""` with an empty title, **When** command is processed, **Then** an error message is displayed indicating title cannot be empty

---

### User Story 5 - Delete Tasks (Priority: P2)

A user wants to remove tasks that are no longer needed. The user enters a "delete" command with a task ID to remove the task from the system.

**Why this priority**: Important for keeping the task list manageable and removing obsolete tasks.

**Independent Test**: Can be fully tested by adding a task, deleting it, and verifying it no longer appears in the task list.

**Acceptance Scenarios**:

1. **Given** user has a task with ID "789", **When** user enters `delete 789`, **Then** the task is removed from the system and confirmation is displayed
2. **Given** user enters `delete 999` where 999 is not a valid task ID, **When** command is processed, **Then** an error message is displayed indicating the task does not exist

---

### Edge Cases

- What happens when a user enters an invalid command not in the supported list? The system should show help information.
- How does the system handle attempts to operate on non-existent task IDs? Appropriate error messages should be shown.
- What occurs when trying to add a task with an empty title? The operation should be rejected.
- How does the system behave when all tasks are deleted? The list command should indicate no tasks exist.

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: System MUST provide a command-line interface for user interaction
- **FR-002**: System MUST allow users to add new tasks with titles via the "add" command
- **FR-003**: System MUST assign each task a unique immutable identifier upon creation
- **FR-004**: System MUST maintain a creation timestamp that does not change after task creation
- **FR-005**: System MUST maintain an updated timestamp that changes whenever the task is modified
- **FR-006**: System MUST allow users to view all tasks via the "list" command
- **FR-007**: System MUST display tasks with ID, title, completion status, and timestamps
- **FR-008**: System MUST allow users to mark tasks as completed via the "complete" command
- **FR-009**: System MUST allow users to update task titles via the "update" command
- **FR-010**: System MUST allow users to delete tasks via the "delete" command
- **FR-011**: System MUST reject operations with invalid or empty titles
- **FR-012**: System MUST display appropriate error messages when operating on non-existent tasks
- **FR-013**: System MUST handle invalid commands gracefully by showing help information
- **FR-014**: System MUST store all tasks in memory only (no persistent storage)
- **FR-015**: System MUST maintain deterministic behavior where identical command sequences produce identical results
- **FR-016**: System MUST prevent crashes due to user input errors

### Key Entities

- **Task**: Represents a single todo item with id, title, completion status, creation time, and updated time
- **TaskRepository**: In-memory storage abstraction that manages persistence of Task entities
- **TodoService**: Business logic layer that validates operations and coordinates between the CLI and TaskRepository

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: Users can add a new task within 10 seconds of entering the command
- **SC-002**: The system displays all tasks in under 1 second regardless of task count (up to 1000 tasks)
- **SC-003**: 100% of valid commands result in successful operations without system crashes
- **SC-004**: All task operations maintain data integrity with unique IDs and proper timestamps
- **SC-005**: The same sequence of commands produces identical results across multiple executions
- **SC-006**: Error conditions are handled gracefully with user-friendly messages instead of crashes
